<template>
  <Segment title="Sá»­ dá»¥ng docker cÆ¡ báº£n">
    <div>
      REF: <a href="https://docs.docker.com/engine/"> chi tiáº¿t</a>
      <Fragment title="CÃ¡c thÃ nh pháº§n trong docker">
        <section>
          <h3> <b>Kiáº¿n trÃºc cá»§a docker(Docker Architecture)</b></h3>
          <img width="720px" style="aspect-ratio: auto 3/4;"
            src="~\assets\images\docker\docker-architecture.webp"></img>
          <h3>ğŸ§± 1. Docker Engine: ÄÃ¢y lÃ  trÃ¡i tim cá»§a Docker - má»™t daemon cháº¡y ná»n, giÃºp xÃ¢y dá»±ng vÃ  cháº¡y container.
          </h3>
          <div>
            Gá»“m cÃ¡c thÃ nh pháº§n
            <ul>
              <li>dockerd: Docker Daemon â€“ nháº­n lá»‡nh tá»« client, quáº£n lÃ½ container, image, v.v.</li>
              <li>docker CLI: CÃ´ng cá»¥ dÃ²ng lá»‡nh Ä‘á»ƒ gá»­i lá»‡nh Ä‘áº¿n dockerd (qua socket hoáº·c REST API).</li>
              <li>REST API: API cho phÃ©p client hoáº·c tool khÃ¡c giao tiáº¿p vá»›i dockerd <a
                  href="https://docs.docker.com/reference/api/engine/" title="docker engine api">chi tiáº¿t</a></li>
            </ul>
          </div>
          <h3>ğŸ“¦ 2. Docker Image</h3>
          <ul>
            <li>
              LÃ  khuÃ´n máº«u (template) báº¥t biáº¿n Ä‘á»ƒ táº¡o container.
            </li>
            <li>
              CÃ³ thá»ƒ coi nhÆ° "snapshot" cá»§a há»‡ thá»‘ng (Linux distro + code + config).
            </li>
            <li>
              ÄÆ°á»£c xÃ¢y tá»« Dockerfile hoáº·c táº£i tá»« Docker Hub.
            </li>
          </ul>
          <h3> ğŸš¢ 3. Docker Container </h3>
          <ul> 
            <li>LÃ  báº£n cháº¡y (runtime instance) cá»§a má»™t image</li>
            <li>CÃ´ láº­p hoÃ n toÃ n, nhÆ°ng nháº¹ hÆ¡n VM (virtual machine).</li>
          </ul>
          <i class="tip">*tip: cÃ³ thá»ƒ dÃ¹ng volume Ä‘á»ƒ chia sáº½ dá»¯ liá»‡u chung cÃ¡c container cÅ©ng nhÆ° host. add, copy Ä‘á»ƒ chuyá»ƒn code dá»¯ liá»‡u vÃ o trong container</i>
       
        <h3>ğŸ“„ 4. Dockerfile: LÃ  táº­p lá»‡nh mÃ´ táº£ cÃ¡ch táº¡o ra image.</h3>
        <h3>ğŸ“‚ 5. Docker Stogre: DÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u bá»n vá»¯ng ngoÃ i container (container cháº¿t â†’ data váº«n cÃ²n).</h3>
        <img width="720px" style="aspect-ratio: auto 3/4;"  src="~\assets\images\docker\docker-storage.png">
        <h4>Bind mounts: `-m | -mount` Mount-point cÃ³ thá»ƒ náº±m á»Ÿ báº¥t ká»³ Ä‘Ã¢u Docker Host khÃ´ng Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi Docker cáº§n pháº£i mount vÃ o thÆ° má»¥c tá»“n táº¡i trÃªn host. thÆ°á»ng dÃ¹ng cho swarm services( gom docker host vá»›i nhau thÃ nh má»™t cá»¥m [cluster])<a href="https://viblo.asia/p/tim-hieu-docker-swarm-OeVKBnGQKkW"> chi tiáº¿t</a></h4>
        <h4>Volume: `-v | -volume` Mount-point sáº½ náº±m á»Ÿ /var/lib/docker/volumes/ cá»§a Docker Host vÃ  Ä‘Æ°á»£c quáº£n lÃ½ báº±ng Docker. thÆ°á»ng dÃ¹ng cho standalone container giá»‘ng nhÆ° bind mount nhÆ°ng Ä‘Æ°á»£c quáº£n lÃ½ á»Ÿ docker lÆ°u trá»¯ táº¡i nÆ¡i nÃ o Ä‘Ã³ trong host tá»± sinh</h4>
        <p> ThÆ°á»ng dÃ¹ng cho</p>
        <ul>
          <li>Database</li>
          <li>logs </li>
          <li>uploads</li>
        </ul>
        <h4>tmpfs: `-mount type=tmpfs,dst=< mount-path > | --tmpfs< mount-path >` khi dÃ¹ng docker trong linux tmpfs mounts data sáº½ Ä‘Æ°á»£c lÆ°u táº¡m vÃ o memory cá»§a Docker Host vÃ  sáº½ máº¥t Ä‘i khi khá»Ÿi Ä‘á»™ng láº¡i hoáº·c stop container. dÃ¹ng khi  muá»‘n báº£o máº­t nÃ¢ng cao hiá»‡u suáº¥t khi ghi má»™t dá»¯ liá»‡u lá»›n khÃ´ng liÃªn tá»¥c khÃ´ng giá»¯ láº¡i trÃªn host hoáº·c container</h4>
        <h3>ğŸ”—6. Docker Network: Cho phÃ©p cÃ¡c container giao tiáº¿p vá»›i nhau hoáº·c vá»›i bÃªn ngoÃ i. Docker táº¡o sáºµn vÃ i loáº¡i máº¡ng: bridge, host, none, overlay. </h3>
        <h3>âš™ 7. Docker Compose: LÃ  cÃ´ng cá»¥ Ä‘á»ƒ Ä‘á»‹nh nghÄ©a vÃ  cháº¡y nhiá»u container cÃ¹ng lÃºc vá»›i file docker-compose.yml quáº£n lÃ½ cÃ¡c docker cáº§n thiáº¿t vÃ  cáº¥u hÃ¬nh má»™t cÃ¡ch nhanh chÃ³ng dá»… dÃ ng</h3>
        <h3>â˜ï¸ 8. Docker Hub (hoáº·c registry khÃ¡c): LÃ  kho lÆ°u trá»¯ image, cho phÃ©p: KÃ©o (pull) image: docker pull node. Äáº©y (push) image báº¡n tá»± build lÃªn server</h3>
        <h3>9. Prune unused Docker objects
 </h3>
 <ul>
  <li>
    image: docker image prune < --filter "string \">(This will remove all dangling images , -a: To remove all images which aren't used by existing containers) 

  </li>
  <li>
    container: docker container prune  < --filter "string \"> (This will remove all stopped containers.)
  </li>
  <li>
    volume: docker volume prune < --filter "string \"> (This will remove all volumes not used by at least one container)
  </li>
  <li>
    network: docker network prune < --filter "string \">  (This will remove all networks not used by at least one container)
  </li>
  <li>
    everything: docker system prune --volumes
  </li>
 </ul>
      </section>
      </Fragment>
      <div>Tá»•ng há»£p vá» docker</div>
      <img src="~\assets\images\docker\docker-summary.png" alt="tá»•ng há»£p vá» docker">
      <img src="~\assets\images\docker\docker-summary-example.png" alt="vÃ­ dá»¥ dÃ¹ng docker">
      <Fragment title="build docker file">
        <div>
          <h3>build docker image syntax</h3>
          <code> docker build [OPTIONS] PATH | URL | - </code>
          <code>docker build -f Dockerfile.dev -t my-image:1.0 . </code>
          <div v-html="content.build"></div>
        </div>
      </Fragment>
    </div>
  </Segment>
</template>

<script lang="ts" setup>
  import { useNuxtApp } from "#app";
  import buildFlag from "./build.md?raw";
  import { reactive, onMounted } from "vue";
  const content = reactive({build: ""});


  // Chá» tá»›i khi mounted (cháº¡y á»Ÿ client) má»›i render markdown
  onMounted(() => {
    const { $renderMarkdown } = useNuxtApp();
    content.build = $renderMarkdown(buildFlag);
  });
</script>

<style></style>
